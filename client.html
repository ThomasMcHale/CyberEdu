<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>CyberEDU</title>
</head>

<body>
	<canvas id="view" width="1280" height="630" style="border:1px solid #000000; position:relative;" onclick="click_position()" onmousemove="rollover_position()"> </canvas>	
	<p id="text"> </p><canvas id="view" > 
</body>

<script src="/socket.io/socket.io.js"></script>
<script>
	var socket = io();
	
	// Debug print function
	function print (s) {
		document.getElementById("text").innerHTML = document.getElementById("text").innerHTML + s + "<br>";
	}
	
	/*
		The following code segment grabs the images from the server and places them in a list
		img_no	image
		0		Coffee Shop
		1		Start Screen
		2 		Inventory
	*/
	var img_list = [];
	var images_received = 0;
	var EXPECTED_IMAGES = 3;
	/* Grabs the script from the server and adds it to the document. 
	I know it works in IE. If this works in Firefox and Chrome as well, 
	we can hide the script from the user in this manner, so they cannot view source on it. */
	socket.on("script", function(info) {
	    var script = document.createElement("SCRIPT");
		script.src = 'data:;base64,' + info.buffer;
		document.body.appendChild(script);		
	});
	socket.on("image", function(info) {
		var img = new Image();
		// Need to wait for image to load before drawing it
		img.onload = function () {
			images_received++;
			img_list[img.id] = img;
			if (img_list.length == EXPECTED_IMAGES)
				go();
		}
		img.src = 'data:image/jpeg;base64,' + info.buffer;
		img.id = info.image;
	});
	socket.emit('request_image');
	
	
</script>

</html>